### MUST BE COMPILED IN UNIX/LINUX ENVIRONMENT ###

OPTS=
LIBS=
BINDIR=../bin
SRC=$(wildcard *.tex)
TMPFILES=$(SRC:%.tex=%.aux)
TMPFILES+=$(SRC:%.tex=%.bbl)
TMPFILES+=$(SRC:%.tex=%.blg)
TMPFILES+=$(SRC:%.tex=%.dvi)
TMPFILES+=$(SRC:%.tex=%.log)
TMPFILES+=$(SRC:%.tex=%.run.xml)
TMPFILES+=$(SRC:%.tex=%.toc)
TMPFILES+=$(SRC:%.tex=%-blx.bib)

.DEFAULT_GOAL := default
.PHONY: all

clean:
	@rm -rfv $(BINDIR)

all: $(SRC:%.tex=%)
	@echo 'Compilation complete for the following files: $(SRC)'

%: %.tex
	mkdir -p $(BINDIR)/$@
	pdflatex $<
	bibtex $@
	pdflatex $<
	pdflatex $<
	mv $@.pdf $(BINDIR)/$@/.
	@echo 'Starting cleanup...'
	@# General cleanup of temporary files
	@# generated by latex and bibtex
	@-rm -fv $(TMPFILES)

default: clean all
